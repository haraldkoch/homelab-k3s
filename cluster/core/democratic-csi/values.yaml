csiDriver:
  # should be globally unique for a given cluster
  name: "org.democratic-csi.nfs"

# on my RPi cluster the liveness probe is timing out before all of the startup lease gathering finishes. disable (for now)
controller:
  livenessProbe:
    enabled: false

  externalProvisioner:
    # copied from default values; overriding timeout from 90s to 180s
    args:
      - --v=5
      - --leader-election
      - --leader-election-namespace={{ .Release.Namespace }}
      - --timeout=180s
      - --worker-threads=10
      - --extra-create-metadata
      - --csi-address=/csi-data/csi.sock

  podAnnotations:
    secret.reloader.stakater.com/reload: zfs-nfs-secret

storageClasses:
  - name: zfs-nfs
    defaultClass: false
    reclaimPolicy: Delete
    volumeBindingMode: Immediate
    allowVolumeExpansion: true
    parameters:
      fsType: nfs

    mountOptions:
      - noatime
      - nfsvers=4
    secrets:
      provisioner-secret:
      controller-publish-secret:
      node-stage-secret:
      node-publish-secret:
      controller-expand-secret:

driver:
  existingConfigSecret: zfs-nfs-secret
  config:
    driver: zfs-generic-nfs

volumeSnapshotClasses:
  - name: zfs-nfs
    annotations:
      k10.kasten.io/is-snapshot-class: "true"
    deletionPolicy: Retain
