rules:
  - name: "docker.io rewrite rule"
    matches:
      - "^docker.io"
    excludes: []
    replace: "harbor.${SECRET_DOMAIN}/dockerhub_proxy"
    checkUpstream: false
  - name: "quay.io rewrite rule"
    matches:
      - "^quay.io"
    excludes: []
    replace: "harbor.${SECRET_DOMAIN}/quay_proxy"
    checkUpstream: false
  - name: "ghcr.io rewrite rule"
    matches:
      - "^ghcr.io"
    excludes: []
    replace: "harbor.${SECRET_DOMAIN}/ghcr_proxy"
    checkUpstream: false

podAnnotations:
  configmap.reloader.stakater.com/reload: "harbor-container-webhook"

affinity:
  nodeAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      nodeSelectorTerms:
        - matchExpressions:
            - key: kubernetes.io/arch
              operator: In
              values:
                - "amd64"

tolerations:
  - key: "node-role.kubernetes.io/control-plane"
    operator: "Exists"
  # Still need this for compatability
  - key: "node-role.kubernetes.io/master"
    operator: "Exists"
