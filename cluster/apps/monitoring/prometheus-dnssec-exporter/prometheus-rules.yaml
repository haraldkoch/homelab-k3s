apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  annotations:
    meta.helm.sh/release-name: ingress-nginx
    meta.helm.sh/release-namespace: networking
    prometheus-operator-validated: "true"
  creationTimestamp: "2021-11-10T21:39:33Z"
  generation: 1
  labels:
    app.kubernetes.io/component: controller
    app.kubernetes.io/instance: ingress-nginx
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: ingress-nginx
    app.kubernetes.io/version: 1.0.4
    helm.sh/chart: ingress-nginx-4.0.6
    helm.toolkit.fluxcd.io/name: ingress-nginx
    helm.toolkit.fluxcd.io/namespace: networking
  name: ingress-nginx-controller
  namespace: networking
  resourceVersion: "61218790"
  uid: 6ea8cb14-89a0-4bdf-b2fe-1fdeca52108a
spec:
  groups:
    - name: dnssec.rules
      rules:
        - alert: DNSSECSignatureExpiration
          expr: dnssec_zone_record_days_left < 10
          for: 1m
          labels:
            severity: critical
          annotations:
            description: The DNSSEC signature for the {{$labels.record}} in {{$labels.zone}} type {{$labels.type}}) expires in {{$value}} day(s)
            summary: A DNSSec signature is expiring

        - alert: DNSSECSignatureInvalid
          expr: dnssec_zone_record_resolves == 0
          for: 1m
          labels:
            severity: critical
          annotations:
            description: The DNSSEC signature for the {{$labels.record}} in {{$labels.zone}} type {{$labels.type}}) on resolver {{$labels.resolver}} is invalid
            summary: A DNSSec signature is invalid
