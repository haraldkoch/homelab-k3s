image:
  repository: ghcr.io/k8s-at-home/velero

configuration:
  extraEnvVars:
    TZ: "America/Toronto"

  provider: aws

  backupStorageLocation:
    name: default
    bucket: velero
    default: true
    config:
      region: minio
      s3ForcePathStyle: true
      s3Url: http://${SECRET_BACKUP_SERVER}:9000
  volumeSnapshotLocation:
    name: default
    provider: org.democratic-csi.nfs

  features: EnableCSI

initContainers:
  - name: velero-plugin-for-aws
    image: ghcr.io/k8s-at-home/velero-plugin-for-aws:v1.3.0
    imagePullPolicy: IfNotPresent
    volumeMounts:
      - mountPath: /target
        name: plugins
  - name: velero-plugin-for-csi
    image: velero/velero-plugin-for-csi:v0.2.0
    imagePullPolicy: IfNotPresent
    volumeMounts:
      - mountPath: /target
        name: plugins

credentials:
  existingSecret: velero-minio-credentials

schedules:
  daily-backup:
    schedule: "0 6 * * *"
    template:
      ttl: "168h"

metrics:
  enabled: true
  serviceMonitor:
    enabled: true
backupsEnabled: true
snapshotsEnabled: true
upgradeCRDs: true
cleanUpCRDs: false

kubectl:
  image:
    repository: ghcr.io/k8s-at-home/kubectl
    tag: v1.22.3

resources:
  requests:
    memory: 300Mi
    cpu: 25m
  limits:
    memory: 1500Mi
